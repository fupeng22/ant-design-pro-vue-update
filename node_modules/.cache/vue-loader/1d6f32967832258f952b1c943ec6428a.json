{"remainingRequest":"D:\\practicespace\\VueProj\\ant-design-pro-vue-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\practicespace\\VueProj\\ant-design-pro-vue-master\\src\\views\\schedule\\schedule.vue?vue&type=style&index=0&id=702b9636&scoped=true&lang=css&","dependencies":[{"path":"D:\\practicespace\\VueProj\\ant-design-pro-vue-master\\src\\views\\schedule\\schedule.vue","mtime":1590808500453},{"path":"D:\\practicespace\\VueProj\\ant-design-pro-vue-master\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\practicespace\\VueProj\\ant-design-pro-vue-master\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\practicespace\\VueProj\\ant-design-pro-vue-master\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\practicespace\\VueProj\\ant-design-pro-vue-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\practicespace\\VueProj\\ant-design-pro-vue-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi5jZWxsLXNlbGVjdCB7DQogIHdpZHRoOiA4MCU7DQp9DQoNCi5yZXNpemUtdGFibGUtdGggew0KICBwb3NpdGlvbjogcmVsYXRpdmU7DQp9DQoNCi50YWJsZS1kcmFnZ2FibGUtaGFuZGxlIHsNCiAgaGVpZ2h0OiAxMDAlICFpbXBvcnRhbnQ7DQogIGJvdHRvbTogMDsNCiAgbGVmdDogYXV0byAhaW1wb3J0YW50Ow0KICByaWdodDogLTVweDsNCiAgY3Vyc29yOiBjb2wtcmVzaXplOw0KICB0b3VjaC1hY3Rpb246IG5vbmU7DQp9DQo="},{"version":3,"sources":["schedule.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgVA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"schedule.vue","sourceRoot":"src/views/schedule","sourcesContent":["<template>\r\n  <a-card :bordered=\"false\">\r\n    <!-- 表头区域 -->\r\n    <div class=\"table-page-search-wrapper\">\r\n      <a-form layout=\"inline\">\r\n        <a-row :gutter=\"48\">\r\n          <a-col :md=\"12\" :sm=\"24\">\r\n            <a-form-item label=\"客户\">\r\n              <a-select placeholder=\"请选择客户\" v-model=\"formParam.customer\">\r\n                <a-select-option value=\"1\">遥望网络科技有限公司</a-select-option>\r\n                <a-select-option value=\"2\">...</a-select-option>\r\n              </a-select>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :md=\"12\" :sm=\"24\">\r\n            <a-form-item label=\"项目:\">\r\n              <a-select placeholder=\"请选择项目\" v-model=\"formParam.project\">\r\n                <a-select-option value=\"1\">...</a-select-option>\r\n                <a-select-option value=\"2\">...</a-select-option>\r\n              </a-select>\r\n            </a-form-item>\r\n          </a-col>\r\n        </a-row>\r\n        <a-row :gutter=\"48\">\r\n          <a-col :md=\"12\" :sm=\"24\">\r\n            <a-form-item label=\"计划编制人\">\r\n              <a-input placeholder=\"请输入编制人\" v-model=\"formParam.user\"/>\r\n            </a-form-item>\r\n          </a-col>\r\n          <a-col :md=\"12\" :sm=\"24\">\r\n            <a-form-item label=\"编制日期:\">\r\n              <a-date-picker style=\"width: 100%\" :format=\"dateFormat\" v-model=\"formParam.createdTime\"/>\r\n            </a-form-item>\r\n          </a-col>\r\n        </a-row>\r\n      </a-form>\r\n    </div>\r\n    <!-- 操作按钮区域 -->\r\n    <div class=\"table-operator\">\r\n      <a-button @click=\"handleAdd\" type=\"primary\" icon=\"plus\">新增</a-button>\r\n    </div>\r\n    <!-- table区域-begin -->\r\n    <div>\r\n      <a-table\r\n        bordered\r\n        :dataSource=\"dataSource\"\r\n        :columns=\"columns\"\r\n        :scroll=\"{ x: 2000, y: 500 }\"\r\n        :components=\"components\"\r\n        :row-key=\"(dataSource) => dataSource.key\">\r\n        <template v-for=\"(item) of keyArr\" v-slot:[item.key]=\"text, props\">\r\n          <div :key=\"item.key\">\r\n            <template v-if=\"item.type === 'edit'\">\r\n              {{ text }}\r\n            </template>\r\n            <a-select\r\n              class=\"cell-select\"\r\n              @change=\"(e) => handleChange(e, props.key, item.key, item.type)\"\r\n              v-else-if=\"item.type === 'select'\">\r\n              <a-select-option v-for=\"op of item.option\" :key=\"op\" :value=\"op\">{{ op }}</a-select-option>\r\n            </a-select>\r\n            <a-date-picker\r\n              :allowClear=\"false\"\r\n              @change=\"(e) => handleChange(e, props[item.key].key, item.key, item.type)\"\r\n              v-else-if=\"item.type === 'date'\"\r\n              :format=\"dateFormat\"/>\r\n            <a-input\r\n              v-else-if=\"item.type === 'input'\"\r\n              :value=\"text\"\r\n              @change=\"(e) => handleChange(e, props.key, item.key, item.type)\"/>\r\n          </div>\r\n        </template>\r\n      </a-table>\r\n    </div>\r\n  </a-card>\r\n</template>\r\n<script>\r\nimport moment from 'moment'\r\nimport scheduleCell from './model/schedule-cell'\r\nimport { store, mutations } from '../../store/application'\r\n\r\nconst CustomCell = (record, rowIndex) => {\r\n  return {\r\n    on: {\r\n      dblclick: (event) => {\r\n        if (event.target.localName === 'input') {\r\n          return true\r\n        }\r\n        record.status = record.status === 'edit' ? 'check' : 'edit'\r\n        console.log(record, rowIndex, event.target.localName, 'custom-cell')\r\n      },\r\n      contextmenu: (event) => {\r\n        console.log(event, 'custom-cell')\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nconst columns = [\r\n  {\r\n    key: '0',\r\n    title: '开始日期',\r\n    dataIndex: 'createTime',\r\n    width: '120',\r\n    align: 'center',\r\n    scopedSlots: { customRender: 'createTime' },\r\n    customCell: CustomCell\r\n  },\r\n  {\r\n    key: '1',\r\n    title: '工作内容',\r\n    dataIndex: 'content',\r\n    width: '100',\r\n    align: 'center',\r\n    scopedSlots: { customRender: 'content' },\r\n    customCell: CustomCell\r\n  },\r\n  {\r\n    key: '2',\r\n    title: '工作方式',\r\n    dataIndex: 'mode',\r\n    width: '100',\r\n    align: 'center',\r\n    scopedSlots: { customRender: 'mode' },\r\n    customCell: CustomCell\r\n  },\r\n  {\r\n    key: '3',\r\n    title: '计划状态',\r\n    dataIndex: 'planStatus',\r\n    width: '100',\r\n    align: 'center',\r\n    scopedSlots: { customRender: 'planStatus' },\r\n    customCell: CustomCell\r\n  },\r\n  {\r\n    key: '4',\r\n    title: '要求完成时间',\r\n    dataIndex: 'requiredTime',\r\n    width: '120',\r\n    align: 'center',\r\n    scopedSlots: { customRender: 'requiredTime' },\r\n    customCell: CustomCell\r\n  },\r\n  {\r\n    key: '5',\r\n    title: '说明',\r\n    dataIndex: 'explain',\r\n    width: '100',\r\n    align: 'center',\r\n    scopedSlots: { customRender: 'explain' },\r\n    customCell: CustomCell\r\n  },\r\n  {\r\n    title: '负责人',\r\n    children: [\r\n      {\r\n        key: '6',\r\n        title: '客户负责人',\r\n        dataIndex: 'customerPserson',\r\n        width: '100',\r\n        align: 'center',\r\n        scopedSlots: { customRender: 'customerPserson' },\r\n        customCell: CustomCell\r\n      },\r\n      {\r\n        key: '7',\r\n        title: '我方负责人',\r\n        dataIndex: 'ourPerson',\r\n        width: '100',\r\n        align: 'center',\r\n        scopedSlots: { customRender: 'ourPerson' },\r\n        customCell: CustomCell\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    key: '8',\r\n    title: '其他参与人',\r\n    dataIndex: 'otherPerson',\r\n    width: '100',\r\n    align: 'center',\r\n    scopedSlots: { customRender: 'otherPerson' },\r\n    customCell: CustomCell\r\n  },\r\n  {\r\n    key: '9',\r\n    title: '完成情况',\r\n    dataIndex: 'completion',\r\n    width: '100',\r\n    align: 'center',\r\n    scopedSlots: { customRender: 'completion' },\r\n    customCell: CustomCell\r\n  }\r\n]\r\nconst draggingMap = {}\r\ncolumns.forEach(col => {\r\n  if (col.children !== undefined) {\r\n    const clim = col.children\r\n    clim.forEach(item => {\r\n      draggingMap[item.key] = item.width\r\n    })\r\n  }\r\n  draggingMap[col.key] = col.width\r\n})\r\nconst draggingState = mutations.SetDraggingMap(draggingMap)\r\nconst keyArray = [\r\n  { key: 'createTime', type: 'date' },\r\n  { key: 'content', type: 'input' },\r\n  { key: 'mode', type: 'select', option: ['开发', '其它'] },\r\n  { key: 'planStatus', type: 'select', option: ['计划', '执行', '完成'] },\r\n  { key: 'requiredTime', type: 'date' },\r\n  { key: 'explain', type: 'input' },\r\n  { key: 'customerPserson', type: 'select', option: ['...', '...', '...', '...'] },\r\n  { key: 'ourPerson', type: 'select', option: ['夏同满', '柯家强', '童建升', '魏宏康'] },\r\n  { key: 'otherPerson', type: 'input' },\r\n  { key: 'completion', type: 'input' }\r\n]\r\nexport default {\r\n  name: 'Schedule',\r\n  components: {\r\n    scheduleCell\r\n  },\r\n  data () {\r\n    return {\r\n      components: {\r\n        header: {\r\n          cell: this.ResizeableTitle\r\n        }\r\n      },\r\n      draggingState: store.draggingState,\r\n      formParam: [],\r\n      dateFormat: 'YYYY-MM-DD',\r\n      settingColumns: [],\r\n      columns,\r\n      dataSource: [\r\n        {\r\n          key: '0',\r\n          status: 'check',\r\n          createTime: moment(Date.now()).format('YYYY-MM-DD'),\r\n          requiredTime: moment(Date.now()).format('YYYY-MM-DD')\r\n        }\r\n      ],\r\n      keyArr: [],\r\n      text: '',\r\n      iconType: ['check'],\r\n      data: []\r\n    }\r\n  },\r\n  methods: {\r\n    moment,\r\n    ResizeableTitle: (h, props, children) => {\r\n      let thDom = null\r\n      const { key, ...restProps } = props\r\n      const col = columns.find(col => {\r\n        const k = col.dataIndex || col.key\r\n        return k === key\r\n      })\r\n      if (!col.width) {\r\n        return <th {...restProps}>{children}</th>\r\n      }\r\n      const onDrag = (x, y) => {\r\n        draggingState[key] = 0\r\n        col.width = Math.max(x, 1)\r\n      }\r\n\r\n      const onDragstop = () => {\r\n        draggingState[key] = thDom.getBoundingClientRect().width\r\n      }\r\n      return (\r\n        <th {...restProps} v-ant-ref={r => (thDom = r)} width={col.width} class=\"resize-table-th\">\r\n          {children}\r\n          <vue-draggable-resizable\r\n            key={col.key}\r\n            class=\"table-draggable-handle\"\r\n            w={10}\r\n            x={draggingState[key] || col.width}\r\n            z={1}\r\n            axis=\"x\"\r\n            draggable={true}\r\n            resizable={false}\r\n            onDragging={onDrag}\r\n            onDragstop={onDragstop}\r\n          ></vue-draggable-resizable>\r\n        </th>\r\n      )\r\n    },\r\n    handleChange (event, key, column, type) {\r\n      console.log(event, key, column, type, 'handleChange')\r\n      let value = ''\r\n      if (type === 'date') {\r\n        value = moment(event).format('YYYY-MM-DD')\r\n      } else if (type === 'select') {\r\n        value = event\r\n      } else {\r\n        value = event.target.value\r\n      }\r\n      const newData = [...this.dataSource]\r\n      const target = newData.filter((item) => key === item.key)[0]\r\n      if (target) {\r\n        target[column] = value\r\n        this.dataSource = newData\r\n      }\r\n    },\r\n    init () {\r\n      this.keyArr = keyArray\r\n      this.columns = columns\r\n    },\r\n    onCellChange (key) {\r\n      console.log(key, 'onCellChange')\r\n      // const dataSource = [...this.dataSource];\r\n      // const target = dataSource.find((item) => item.key === key);\r\n      // if (target) {\r\n      //     target[dataIndex] = value;\r\n      //     this.dataSource = dataSource;\r\n      // }\r\n    },\r\n    handleAdd () {\r\n      const { dataSource } = this\r\n      const count = dataSource.length\r\n      const date = moment(Date.now()).format('YYYY-MM-DD')\r\n      const newData = { key: count, status: 'check', createTime: date, requiredTime: date }\r\n      this.dataSource = [...dataSource, newData]\r\n    },\r\n\r\n    handleCell (record) {\r\n      console.log(record, 'handelCell')\r\n    }\r\n  },\r\n  created () {\r\n    this.init()\r\n  }\r\n\r\n}\r\n</script>\r\n<style scoped>\r\n.cell-select {\r\n  width: 80%;\r\n}\r\n\r\n.resize-table-th {\r\n  position: relative;\r\n}\r\n\r\n.table-draggable-handle {\r\n  height: 100% !important;\r\n  bottom: 0;\r\n  left: auto !important;\r\n  right: -5px;\r\n  cursor: col-resize;\r\n  touch-action: none;\r\n}\r\n</style>\r\n"]}]}